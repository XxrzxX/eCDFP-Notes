# File Metadata

## Metadata

Metadata is data about data.

### Common Places to Find It

- MFT (Master File Table)
- Root directory
- File header
- Magic number

### Metadata Types

- **System Metadata:** Generated by the file system.
- **Substantive Metadata:** Contains information about modifications made to a document.
- **Embedded Metadata:** Embedded by applications that edit or create files within the file itself.
- **External Metadata:** Created separately by file management software to keep track of managed files.

#### System Metadata

- **MAC (Modified, Accessed, Created) Times:**
    - **Entry Modified:** Holds the last time an attribute was modified. Note: It doesn't specify which attribute was changed.

### Document Metadata System

It's a good source to check before gathering data, but we need first to understand how and where it is stored.

### How Metadata Helps in Solving Cases

Metadata can significantly aid in investigations if you know where to look.

## File Header

Applications use file headers to determine the type of file. Each file type has a unique header.

## Magic Number

A unique string at the beginning of the file. To check the list of file magic numbers on Linux: `/usr/share/file/magic`.

## Temporary Files

Temporary files are used to keep track of changes by applications and are deleted when the application exits. However, if the application crashes, the temporary file may remain in the system. There are many reasons for creating temporary files, so understanding them is necessary during investigations.

### Swapping

Swapping is a process that frees up space in RAM by saving inactive application data to the disk and then returning it to RAM when needed to continue processing.

### Caching

Some OS utilities use caching to store recent activities, making it easier to retrieve this information later.

## Data Hiding Locations

- Metadata
- Windows Registry (some apps, even after deletion, can leave behind registry keys)
- ADS (Alternate Data Streams) will not affect the file size (use FAT to remove them)
- Root of Recycle Bin

## Tools

### Analyzing MFT and Root Directory

- Disk Explorer for NTFS 

### File Analysis

- File command (identify file types)

### Locating Hidden Data

- Strings
- Bstrings

### Analyzing ADS

- Streams (from Sysinternals)
- ADS Detector

## File Type Identification

- `file` command
    
    ```
    for name in $(ls $1)
    do
        file $name
    done
    
    ```
    
- HxD (hex editor)

### PDF Analysis Tools

- [HxD](https://mh-nexus.de/en/hxd/)
- [PDFID](https://www.kali.org/tools/pdfid/)
- [PDF-Parser](https://www.kali.org/tools/pdf-parser/) (options: -stats, --search, --object=[id], --filter, --raw)

### Office Files Analysis Tools

- [OfficemalScanner](https://www.optimizationcore.com/security/officemalscanner-microsoft-office-files-malware-scanner/) (info, scan, brute, debug)



## EXIF Data Analysis

- [PyExif-GUI](https://hvdwolf.github.io/pyExifToolGUI/manual/pyexiftoolgui.html#:~:text=pyExifToolGui%20is%20a%20python%20pySide%20QT4%20script%20program,python%2C%20GUI%20for%20Graphical%20User%20Interface%20to%20ExifTool.)
- [Jeffrey's EXIF Viewer](https://openminds.exopaedia.org/EXIF%20samples/exif%2069667671.egLsAwK4.Staroselciweb64_6625.htm)
- [ExifTool](https://exiftool.org/)
    
    ```
    find -type f -print -exec exiftool -filetype {} \\;
    
    ```